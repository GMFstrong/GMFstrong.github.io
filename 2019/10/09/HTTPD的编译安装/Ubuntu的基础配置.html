<hr>
<p>title: Ubuntu的基础配置<br>date: 2019-11-27 20:00:09<br>tags:</p>
<h2 id="categories-linux"><a href="#categories-linux" class="headerlink" title="categories: linux"></a>categories: linux</h2><blockquote>
<p>1) 修改主机名：</p>
</blockquote>
<pre><code>root@gmf:~# cat /etc/hostname 
gmf.testroot.com
</code></pre><blockquote>
<p>2) 修改网卡名：</p>
</blockquote>
<pre><code>root@gmf:~# cat /etc/default/grub
GRUB_CMDLINE_LINUX=&quot;net.ifnames=0 biosdevname=0&quot;

reboot
</code></pre><blockquote>
<p>3) 配置Ubuntu的root用户连接：</p>
</blockquote>
<pre><code>root@gmf:~# vim /etc/ssh/sshd_config 
PermitRootLogin yes
PasswordAuthentication yes
sudo su - root  #切换root设置密码。
 systemctl restart sshd #重启ssh服务并测试root用户远程ssh连接
</code></pre><blockquote>
<p>4) 配置Ubuntu的网卡：</p>
</blockquote>
<pre><code>ubuntu 17.04及之前的静态IP配置方式：
    cat /etc/network/interfaces
        # interfaces(5) file used by ifup(8) and ifdown(8)
        auto lo
        iface lo inet loopback
        auto eth0 #网卡自启动，写自己要配置IP的实际网卡名称
        iface eth0 inet static #配置静态IP，写自己要配置IP的实际网卡名称
        address 172.18.3.12 #IP地址
        netmask 255.255.0.0 #掩码
        gateway 172.18.0.1 #网关
        dns-nameservers 223.6.6.6 #DNS
        dns-nameservers 223.5.5.5
    #重启网络服务
    /etc/init.d/networking restart
    systemctl restart networking.service
ubuntu 18.04配置静态IP地址:
    vim /etc/netplan/01-netcfg.yaml
        network:
            version: 2
            renderer: networkd
            ethernets:
                eth0:
                    dhcp4: no
                    addresses: [192.168.38.201/24]
                    gateway4: 192.168.38.2
                    nameservers:
                            addresses: [192.168.38.2]

                eth1:
                    dhcp4: no
                    addresses: [172.18.8.201/16]
                    routes:
                        - to: 172.30.0.0/16
                        via: 172.18.0.1
                        - to: 172.17.0.0/16
                        via: 172.18.0.1
    netplan apply  #是当前配置生效。
vim ~/.vimrc #取消vim 自动缩进功能
set past
</code></pre><blockquote>
<p>4) 配置网卡桥接：</p>
</blockquote>
<pre><code>network:
  version: 2
  renderer: networkd
  ethernets:
    eth0:
      dhcp4: no

  bridges:
    br0:
      dhcp4: no
      addresses: [192.168.38.201/24]
      gateway4: 192.168.38.2
      nameservers:
          addresses: [192.168.38.2]
      interfaces:
          - eth0
</code></pre><blockquote>
<p>5) 多网卡绑定（bond）:</p>
</blockquote>
<pre><code>第一种模式：mod=0，即：(balance-rr) Round-robin policy（平衡抡循环策略）
特点：传输数据包顺序是依次传输（即：第1个包走eth0，下一个包就走eth1….一直循环下去，直到最后一个传
输完毕），此模式提供负载平衡和容错能力。
第二种模式：mod=1，即： (active-backup) Active-backup policy（主-备份策略）
特点：只有一个设备处于活动状态，当一个宕掉另一个马上由备份转换为主设备。mac地址是外部可见得，从外面
看来，bond的MAC地址是唯一的，以避免switch(交换机)发生混乱。此模式只提供了容错能力；由此可见此算法
的优点是可以提供高网络连接的可用性，但是它的资源利用率较低，只有一个接口处于工作状态，在有 N 个网络
接口的情况下，资源利用率为1/N。
第三种模式：mod=2，即：(balance-xor) XOR policy（平衡策略）
特点：基于指定的传输HASH策略传输数据包。缺省的策略是：(源MAC地址 XOR 目标MAC地址) % slave数量。
其他的传输策略可以通过xmit_hash_policy选项指定，此模式提供负载平衡和容错能力。
第四种模式：mod=3，即：broadcast（广播策略）
特点：在每个slave接口上传输每个数据包，此模式提供了容错能力。
第五种模式：mod=4，即：(802.3ad) IEEE 802.3adDynamic link aggregation（IEEE 802.3ad 动态
链接聚合）
特点：创建一个聚合组，它们共享同样的速率和双工设定。根据802.3ad规范将多个slave工作在同一个激活的聚
合体下。
必要条件：
条件1：ethtool支持获取每个slave的速率和双工设定。
条件2：switch(交换机)支持IEEE 802.3ad Dynamic link aggregation。
条件3：大多数switch(交换机)需要经过特定配置才能支持802.3ad模式。
第六种模式：mod=5，即：(balance-tlb) Adaptive transmit load balancing（适配器传输负载均
衡）
特点：不需要任何特别的switch(交换机)支持的通道bonding。在每个slave上根据当前的负载（根据速度计
算）分配外出流量。如果正在接受数据的slave出故障了，另一个slave接管失败的slave的MAC地址。
该模式的必要条件：
ethtool支持获取每个slave的速率
第七种模式：mod=6，即：(balance-alb) Adaptive load balancing（适配器适应性负载均衡）
特点：该模式包含了balance-tlb模式，同时加上针对IPV4流量的接收负载均衡(receive load balance,
rlb)，而且不需要任何switch(交换机)的支持。
一般根据情况大多用0,1,4策略。

network:
  version: 2
  renderer: networkd
  ethernets:
    eth0:
      dhcp4: no
      dhcp6: no
    eth1:
      dhcp4: no
      dhcp6: no
  bonds:
    bond0:
      interfaces:
        - eth0
        - eth1
      addresses: [192.168.38.201/24]
      gateway4: 192.168.38.2
      nameservers:
        addresses: [192.168.38.2]
      parameters:
        mode: active-backup
        mii-monitor-interval: 100
</code></pre><blockquote>
<p>6) 基于bond的桥接：</p>
</blockquote>
<pre><code>network:
  version: 2
  renderer: networkd
  ethernets:
    eth0:
      dhcp4: no
      dhcp6: no
    eth1:
      dhcp4: no
      dhcp6: no
  bonds:
    bond0:
      interfaces:
        - eth0
        - eth1
      parameters:
        mode: active-backup
        mii-monitor-interval: 100
  bridges:
    br0:
      dhcp4: no
      addresses: [192.168.38.201/24]
      gateway4: 192.168.38.2
      nameservers:
        addresses: [192.168.38.2]
      interfaces:
        - bond0
</code></pre>