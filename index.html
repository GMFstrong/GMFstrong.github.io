<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ConqUeroR</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="From Zero to the DevOps">
<meta property="og:type" content="website">
<meta property="og:title" content="ConqUeroR">
<meta property="og:url" content="http://gmfdevops.com.com/index.html">
<meta property="og:site_name" content="ConqUeroR">
<meta property="og:description" content="From Zero to the DevOps">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ConqUeroR">
<meta name="twitter:description" content="From Zero to the DevOps">
  
    <link rel="alternative" href="/atom.xml" title="ConqUeroR" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1530275036756&amp;di=fbef4a64ede1f8237b28de7618e9a502&amp;imgtype=0&amp;src=http%3A%2F%2Ftx.haiqq.com%2Fuploads%2Fallimg%2F170507%2F0Q25BU9-8.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">ConqUeroR</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/categories/websec">Web安全</a></li>
				        
							<li><a href="/categories/linux">Linux运维</a></li>
				        
							<li><a href="/categories/shell">Shell编程</a></li>
				        
							<li><a href="/categories/python">Python脚本</a></li>
				        
							<li><a href="/categories/network">网络配置</a></li>
				        
							<li><a href="/categories/other">其它</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">ConqUeroR</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1530275036756&amp;di=fbef4a64ede1f8237b28de7618e9a502&amp;imgtype=0&amp;src=http%3A%2F%2Ftx.haiqq.com%2Fuploads%2Fallimg%2F170507%2F0Q25BU9-8.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">ConqUeroR</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/categories/websec">Web安全</a></li>
		        
					<li><a href="/categories/linux">Linux运维</a></li>
		        
					<li><a href="/categories/shell">Shell编程</a></li>
		        
					<li><a href="/categories/python">Python脚本</a></li>
		        
					<li><a href="/categories/network">网络配置</a></li>
		        
					<li><a href="/categories/other">其它</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-Raid磁盘阵列" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/08/09/Raid磁盘阵列/" class="article-date">
  	<time datetime="2019-08-09T11:47:28.000Z" itemprop="datePublished">2019-08-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/09/Raid磁盘阵列/">
        Raid磁盘阵列
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong><em>在生产环境中考虑到所需硬盘存储量太大，并且对数据有一定冗余要求，RAID恰好能满足这一需求。</em></strong></p>
<blockquote>
<p>整个 RAID由于选择的等级 (level) 不同，而使得整合后的磁盘具有不同的功能， 基本常见的 level 有这几种:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">（1）raid0</span><br><span class="line">（2）raid1</span><br><span class="line">（3）raid5</span><br><span class="line">（4）raid10</span><br><span class="line">（5）raid01</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><strong><em>下面介绍一下RAID中的一些基本概念：</em></strong><br>（1）在组成RAID的多块磁盘中，通常会依照众多磁盘中容量最小的磁盘作为参照，例如有1T,2T,3T的几块磁盘，则会依照每块1T大小的磁盘容量使用RAID。故而最好使用型号与容量大小的磁盘组成RAID。</p>
<h3 id="RAID0-性能加强，容量加大，风险加大。"><a href="#RAID0-性能加强，容量加大，风险加大。" class="headerlink" title="RAID0:性能加强，容量加大，风险加大。"></a>RAID0:性能加强，容量加大，风险加大。</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这种模式的 RAID 会将磁盘先切出等量的区块 (举例来说， 4KB)， 然后当一个文件要写入 RAID 时，该文件会依据区块的大小切割好，之后再依序放到各个磁碟里面去。由於每个磁碟会交错的存放数据， 因此当你的数据要写入 RAID 时，数据会被等量的放置在各个磁碟上面。举例来说，你有两块磁盘组成 RAID-0 ， 当你有 100MB 的数据要写入时，每个磁盘会各被分配到 50MB 的储存量。如下图：</span><br></pre></td></tr></table></figure>
<img src="/2019/08/09/Raid磁盘阵列/raid0.gif">
<blockquote>
<p>读写性能提升：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">上图的意思是，在组成 RAID-0 时，每颗磁盘 (Disk A 与 Disk B) 都会先被分隔成为小区块 (chunk)。 当有数据要写入 RAID 时，数据会先被切割成符合小区块的大小，然后再依序一个一个的放置到不同的磁盘去。 由於数据已经先被切割并且依序放置到不同的磁盘上面，因此每块磁盘所负责的数据量都降低了！照这样的情况来看， 越多磁盘组成的 RAID-0 效能会越好，因为每块磁盘负责的数据量就更低了！ 这表示我的数据可以分散让多块磁盘来储存，当然性能会变的更好啊！此外，磁盘总容量也变大了！ 因为所有磁碟的容量总和成为 RAID-0 的总容量。</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>数据丢失风险增大：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">只是使用此等级你必须要自行负担数据损毁的风险，由上图我们知道文件是被切割成为适合每块磁盘分区区块的大小， 然后再依序放置到各个磁盘中。想一想，如果某一块磁盘损毁了，那么文件数据将缺一块，此时这个文件就损毁了。 由於每个文件都是这样存放的，因此 RAID-0 只要有任何一颗磁盘损毁，在 RAID 上面的所有数据都会遗失而无法读取。</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>为什么最好选择相同型号与容量的磁盘来组成RAID<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果使用不同容量的磁盘来组成 RAID-0 时，由于数据是一直等量的依序放置到不同磁盘中，当小容量磁盘的区块被用完了， 那么所有的数据都将被写入到最大的那颗磁盘去。举例来说，我用 200G 与 500G 组成 RAID-0 ， 那么最初的 400GB 数据可同时写入两块磁盘 (各消耗 200G 的容量)，后来再加入的数据就只能写入 500G 的那块磁盘中了。 此时的效能就变差了，因为只剩下一块可以存放数据。</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="RAID1-完整的备份容量损失50-，读性能提升，写性能不变。"><a href="#RAID1-完整的备份容量损失50-，读性能提升，写性能不变。" class="headerlink" title="RAID1 完整的备份容量损失50%，读性能提升，写性能不变。"></a>RAID1 完整的备份容量损失50%，读性能提升，写性能不变。</h3><blockquote>
<p>完整的备份容量损失50%：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这种模式主要是『让同一份数据，完整的保存在两块磁盘上面』。举例来说，如果我有一个 100MB 的文件，且我仅有两块磁盘组成 RAID-1 时，那么这两块磁盘将会同步写入 100MB 到他们的储存空间去。 因此，整体 RAID 的容量几乎少了 50%。如下图:</span><br></pre></td></tr></table></figure></p>
</blockquote>
<img src="/2019/08/09/Raid磁盘阵列/raid1.gif">
<blockquote>
<p>写性能不变（有可能变差）:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如上图所示，一份数据传送到 RAID-1 之后会被分为两股，并分别写入到各个磁盘里头去。 由于同一份数据会被分别写入到其他不同磁盘，因此如果要写入 100MB 时，数据传送到 I/O 汇流排 后会被复制多份到各个磁盘， 结果就是数据量感觉变大了！因此在大量写入 RAID-1 的情况下，写入的效能可能会变的非常差 (因为我们只有一个南桥啊！)。 好在如果你使用的是硬件 RAID (磁盘阵列卡) 时，磁盘阵列卡会主动的复制一份而不使用系统的 I/O 汇流排，效能方面则还可以。 如果使用软件磁盘阵列，可能效能就不好了。</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>读性能提升:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">虽然 RAID-1 的写入效能不佳，不过读取的效能则还可以啦！这是因为数据有两份在不同的磁碟上面，如果多个 processes 在读取同一份数据时， RAID 会自行取得最佳的读取平衡。</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="RAID01和RAID10：完整的备份容量损失50-，读写性能提升："><a href="#RAID01和RAID10：完整的备份容量损失50-，读写性能提升：" class="headerlink" title="RAID01和RAID10：完整的备份容量损失50%，读写性能提升："></a>RAID01和RAID10：完整的备份容量损失50%，读写性能提升：</h3><img src="/2019/08/09/Raid磁盘阵列/raid01.gif">
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如上图所示，Disk A + Disk B 组成第一组 RAID 0，Disk C + Disk D 组成第二组 RAID 0， 然后这两组再整合成为一组 RAID 1。如果我有 100MB 的数据要写入，则由於 RAID 1 的关系， 两组 RAID 0 都会写入 100MB，但由於 RAID 0 的关系，因此每块磁盘仅会写入 50MB 而已。 如此一来不论哪一组 RAID 0 的磁盘损毁，只要另外一组 RAID 0 还存在，那么就能够透过 RAID 1 的机制来回复数据。</span><br><span class="line">由於具有 RAID 0 的优点，所以效能得以提升，由於具有 RAID 1 的优点，所以数据得以备份。 但是也由於 RAID 1 的缺点，所以总容量会少一半用来做为备份！</span><br><span class="line">而RAID10的方式与RAID01类似。</span><br></pre></td></tr></table></figure>
<h3 id="RAID5：性能与数据备份的均衡考量"><a href="#RAID5：性能与数据备份的均衡考量" class="headerlink" title="RAID5：性能与数据备份的均衡考量"></a>RAID5：性能与数据备份的均衡考量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RAID-5 至少需要三块以上的磁盘才能够组成这种类型的磁盘阵列。这种磁盘阵列的数据写入有点类似 RAID-0 ， 不过每个循环的写入过程中，在每块磁盘还加入一个同位检查数据 (Parity) ，这个数据会记录其他磁盘的备份数据， 用於当有磁盘损毁时的救援。RAID-5 读写的情况如下图：</span><br></pre></td></tr></table></figure>
<img src="/2019/08/09/Raid磁盘阵列/raid5.gif">
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如上图所示，每个循环写入时，都会有部分的同位检查码 (parity) 被记录起来，并且记录的同位检查码每次都记录在不同的磁盘， 因此，任何一个磁盘损毁时都能够由其他磁盘的检查码来重建原本磁盘内的数据！不过需要注意的是， 由於有同位检查码，因此 RAID 5 的总容量会是整体磁盘数量减一块。</span><br></pre></td></tr></table></figure>
<blockquote>
<p>读写性能方面：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在读写效能的比较上，读取的效能还不赖！与 RAID-0 有的比！不过写的效能就不见得能够添加很多！ 这是因为要写入 RAID 5 的数据还得要经过计算同位检查码 (parity) 的关系。由於加上这个计算的动作， 所以写入的效能与系统的硬件关系较大！尤其当使用软件磁盘阵列时，同位检查码是透过 CPU 去计算而非专职的磁盘阵列卡， 因此效能方面还需要评估。</span><br><span class="line"></span><br><span class="line">另外，由於 RAID 5 仅能支持一颗磁盘的损毁，因此近来还有发展出另外一种等级，就是 RAID 6 ，这个 RAID 6 则使用两块磁盘的容量作为 parity 的储存，因此整体的磁盘容量就会少两块，但是允许出错的磁盘数量就可以达到两块！ 也就是在 RAID 6 的情况下，同时两颗磁盘损毁时，数据还是可以救回来！</span><br></pre></td></tr></table></figure></p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-基于http的yum源服务器的搭建" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/08/08/基于http的yum源服务器的搭建/" class="article-date">
  	<time datetime="2019-08-08T06:00:47.000Z" itemprop="datePublished">2019-08-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/08/基于http的yum源服务器的搭建/">
        基于http的yum源服务器的搭建
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong><em>首先介绍yum命令的常用选项</em></strong></p>
<blockquote>
<p>显示yum仓库的列表：</p>
</blockquote>
<pre><code>yum repolist 
</code></pre><p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]#yum repolist</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line"> * extras: mirror-hk.koddos.net</span><br><span class="line"> * updates: mirror.lzu.edu.cn</span><br><span class="line"> repo id                                                                   repo name                                                                    status</span><br><span class="line">base/7/x86_64                                                             CentOS-7 - Base                                                              4,021</span><br><span class="line">extras/7/x86_64                                                           CentOS-7 - Extras                                                              435</span><br><span class="line">updates/7/x86_64                                                          CentOS-7 - Updates                                                           2,500</span><br><span class="line">repolist: 6,956</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>显示程序包：</p>
</blockquote>
<pre><code>yum list
</code></pre><p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost yum.repos.d]#yum list | tail</span><br><span class="line">Repository base is listed more than once in the configuration</span><br><span class="line">yum-langpacks.noarch                     0.4.2-7.el7                   base     </span><br><span class="line">yum-plugin-aliases.noarch                1.1.31-50.el7                 base     </span><br><span class="line">yum-plugin-changelog.noarch              1.1.31-50.el7                 base     </span><br><span class="line">yum-plugin-tmprepo.noarch                1.1.31-50.el7                 base     </span><br><span class="line">yum-plugin-verify.noarch                 1.1.31-50.el7                 base     </span><br><span class="line">yum-plugin-versionlock.noarch            1.1.31-50.el7                 base     </span><br><span class="line">yum-utils.noarch                         1.1.31-50.el7                 base     </span><br><span class="line">zenity.x86_64                            3.28.1-1.el7                  base     </span><br><span class="line">zsh.x86_64                               5.0.2-31.el7                  base     </span><br><span class="line">zziplib.x86_64                           0.13.62-9.el7                 base</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>安装程序包：</p>
</blockquote>
<pre><code>yum install 
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-q：静默模式</span><br><span class="line">-y: 自动回答为“yes”</span><br><span class="line">--nogpgcheck：禁止进行gpg check</span><br></pre></td></tr></table></figure>
<p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum install -q -y wget</span><br><span class="line">[root@localhost ~]#</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>重新安装<br>    yum reinstall</p>
</blockquote>
<p>例如:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum reinstall wget</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.neusoft.edu.cn</span><br><span class="line"> * extras: mirrors.neusoft.edu.cn</span><br><span class="line"> * updates: mirrors.neusoft.edu.cn</span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package wget.x86_64 0:1.14-18.el7_6.1 will be reinstalled</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>卸载程序包：</p>
</blockquote>
<pre><code>yum remove
</code></pre><p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum remove wget</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package wget.x86_64 0:1.14-18.el7_6.1 will be erased</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>查看程序包信息:</p>
</blockquote>
<pre><code>yum info
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum info wget</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.neusoft.edu.cn</span><br><span class="line"> * extras: mirrors.neusoft.edu.cn</span><br><span class="line"> * updates: mirrors.neusoft.edu.cn</span><br><span class="line">Available Packages</span><br><span class="line">Name        : wget</span><br><span class="line">Arch        : x86_64</span><br><span class="line">Version     : 1.14</span><br><span class="line">Release     : 18.el7_6.1</span><br><span class="line">Size        : 547 k</span><br><span class="line">Repo        : updates/7/x86_64</span><br><span class="line">Summary     : A utility for retrieving files using the HTTP or FTP protocols</span><br><span class="line">URL         : http://www.gnu.org/software/wget/</span><br><span class="line">License     : GPLv3+</span><br><span class="line">Description : GNU Wget is a file retrieval utility which can use either the HTTP or</span><br><span class="line">            : FTP protocols. Wget features include the ability to work in the</span><br><span class="line">            : background while you are logged out, recursive retrieval of</span><br><span class="line">            : directories, file name wildcard matching, remote file timestamp</span><br><span class="line">            : storage and comparison, use of Rest with FTP servers and Range with</span><br><span class="line">            : HTTP servers to retrieve files over slow or unstable connections,</span><br><span class="line">            : support for Proxy servers, and configurability.</span><br></pre></td></tr></table></figure>
<blockquote>
<p>查看指定的特性(可以是某文件)是由哪个程序包所提供：</p>
</blockquote>
<pre><code>yum provides
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum provides /usr/share/locale/eu/LC_MESSAGES/wget.mo</span><br><span class="line">wget-1.14-18.el7.x86_64 : A utility for retrieving files using the HTTP or FTP protocols</span><br><span class="line">Repo        : base</span><br><span class="line">Matched from:</span><br><span class="line">Filename    : /usr/share/locale/eu/LC_MESSAGES/wget.mo</span><br></pre></td></tr></table></figure>
<blockquote>
<p>清理本地缓存：</p>
</blockquote>
<pre><code>yum clean all [ packages | metadata | expire-cache | rpmdb | plugins ]
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum clean all</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Cleaning repos: base extras updates</span><br><span class="line">Cleaning up everything</span><br><span class="line">Cleaning up list of fastest mirrors</span><br></pre></td></tr></table></figure>
<blockquote>
<p>构建缓存：</p>
</blockquote>
<pre><code>yum makecache
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum makecache</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">base                                                                                                                                  | 3.6 kB  00:00:00     </span><br><span class="line">extras                                                                                                                                | 3.4 kB  00:00:00     </span><br><span class="line">updates                                                                                                                               | 3.4 kB  00:00:00     </span><br><span class="line">(1/8): extras/7/x86_64/prestodelta                                                                                                    |  73 kB  00:00:00     </span><br><span class="line">(2/8): extras/7/x86_64/other_db                                                                                                       | 131 kB  00:00:00     </span><br><span class="line">(3/8): updates/7/x86_64/prestodelta                                                                                                   | 945 kB  00:00:00     </span><br><span class="line">(4/8): updates/7/x86_64/filelists_db                                                                                                  | 5.2 MB  00:00:01     </span><br><span class="line">(5/8): base/7/x86_64/other_db                                                                                                         | 2.6 MB  00:00:01     </span><br><span class="line">(6/8): updates/7/x86_64/other_db                                                                                                      | 764 kB  00:00:00     </span><br><span class="line">(7/8): extras/7/x86_64/filelists_db                                                                                                   | 249 kB  00:00:02     </span><br><span class="line">(8/8): base/7/x86_64/filelists_db                                                                                                     | 7.1 MB  00:00:07     </span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line"> * extras: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line"> * updates: mirrors.neusoft.edu.cn</span><br><span class="line">Metadata Cache Created</span><br></pre></td></tr></table></figure>
<blockquote>
<p>搜索（以指定的关键字搜索程序包名及summary信息）</p>
</blockquote>
<pre><code>yum search
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum search mysql</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line"> * extras: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line"> * updates: mirrors.neusoft.edu.cn</span><br><span class="line">==================================================================== N/S matched: mysql =====================================================================</span><br><span class="line">MySQL-python.x86_64 : An interface to MySQL</span><br><span class="line">akonadi-mysql.x86_64 : Akonadi MySQL backend support</span><br><span class="line">apr-util-mysql.x86_64 : APR utility library MySQL DBD driver</span><br><span class="line">dovecot-mysql.x86_64 : MySQL back end for dovecot</span><br><span class="line">freeradius-mysql.x86_64 : MySQL support for freeradius</span><br><span class="line">libdbi-dbd-mysql.x86_64 : MySQL plugin for libdbi</span><br><span class="line">mysql-connector-java.noarch : Official JDBC driver for MySQL</span><br><span class="line">mysql-connector-odbc.x86_64 : ODBC driver for MySQL</span><br><span class="line">pcp-pmda-mysql.x86_64 : Performance Co-Pilot (PCP) metrics for MySQL</span><br></pre></td></tr></table></figure>
<blockquote>
<p>查看指定包所依赖的capabilities：</p>
</blockquote>
<pre><code>yum deplist
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum deplist httpd</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line"> * extras: mirrors.tuna.tsinghua.edu.cn</span><br><span class="line"> * updates: mirrors.neusoft.edu.cn</span><br><span class="line">package: httpd.x86_64 2.4.6-89.el7.centos.1</span><br><span class="line">  dependency: /bin/sh</span><br><span class="line">   provider: bash.x86_64 4.2.46-31.el7</span><br><span class="line">  dependency: /etc/mime.types</span><br><span class="line">   provider: mailcap.noarch 2.1.41-2.el7</span><br><span class="line">  dependency: /usr/sbin/groupadd</span><br><span class="line">   provider: shadow-utils.x86_64 2:4.1.5.1-25.el7_6.1</span><br></pre></td></tr></table></figure>
<blockquote>
<p>查看yum事务历史：</p>
</blockquote>
<pre><code>yum history [redo|undo|info|list|packages-list|packages-info|summary|addon-info]
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#yum history</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">ID     | Login user               | Date and time    | Action(s)      | Altered</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">     8 | root &lt;root&gt;              | 2019-08-08 23:54 | I, U           |   11 EE</span><br><span class="line">     7 | root &lt;root&gt;              | 2019-08-08 23:38 | Install        |    1   </span><br><span class="line">     6 | root &lt;root&gt;              | 2019-08-08 23:33 | Erase          |    1   </span><br><span class="line">     5 | root &lt;root&gt;              | 2019-08-08 23:27 | Reinstall      |    1   </span><br><span class="line">     4 | root &lt;root&gt;              | 2019-08-08 23:24 | Install        |    1   </span><br><span class="line">     3 | root &lt;root&gt;              | 2019-08-08 22:54 | Install        |    1   </span><br><span class="line">     2 | root &lt;root&gt;              | 2019-08-08 22:35 | Install        |   31   </span><br><span class="line">     1 | System &lt;unset&gt;           | 2019-07-18 04:34 | Install        |  279   </span><br><span class="line">history list</span><br><span class="line">[root@localhost ~]#yum history info 8</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Transaction ID : 8</span><br><span class="line">Begin time     : Thu Aug  8 23:54:00 2019</span><br><span class="line">Begin rpmdb    : 312:7e4bbf6cb5316d8b59796ab2493c12e8c4bf7aca</span><br><span class="line">End time       :            23:54:23 2019 (23 seconds)</span><br><span class="line">End rpmdb      : 319:4f1b22d936cae2c01881c331147218195e37e7c3</span><br><span class="line">User           : root &lt;root&gt;</span><br><span class="line">Return-Code    : Success</span><br><span class="line">Command Line   : install -y gcc</span><br><span class="line">Transaction performed with:</span><br><span class="line">    Installed     rpm-4.11.3-17.el7.x86_64                      @anaconda</span><br><span class="line">    Installed     yum-3.4.3-132.el7.centos.0.1.noarch           @anaconda</span><br><span class="line">    Installed     yum-plugin-fastestmirror-1.1.31-34.el7.noarch @anaconda</span><br><span class="line">Packages Altered:</span><br><span class="line">    Dep-Install cpp-4.8.5-36.el7_6.2.x86_64               @updates</span><br><span class="line">    Install     gcc-4.8.5-36.el7_6.2.x86_64               @updates</span><br><span class="line">    Updated     glibc-2.17-105.el7.x86_64                 @anaconda</span><br><span class="line">    Update            2.17-260.el7_6.6.x86_64             @updates</span><br><span class="line">    Updated     glibc-common-2.17-105.el7.x86_64          @anaconda</span><br><span class="line">    Update                   2.17-260.el7_6.6.x86_64      @updates</span><br><span class="line">    Dep-Install glibc-devel-2.17-260.el7_6.6.x86_64       @updates</span><br><span class="line">    Dep-Install glibc-headers-2.17-260.el7_6.6.x86_64     @updates</span><br><span class="line">    Dep-Install kernel-headers-3.10.0-957.27.2.el7.x86_64 @updates</span><br><span class="line">    Updated     libgcc-4.8.5-4.el7.x86_64                 @anaconda</span><br><span class="line">    Update             4.8.5-36.el7_6.2.x86_64            @updates</span><br><span class="line">    Updated     libgomp-4.8.5-4.el7.x86_64                @anaconda</span><br><span class="line">    Update              4.8.5-36.el7_6.2.x86_64           @updates</span><br><span class="line">    Dep-Install libmpc-1.0.1-3.el7.x86_64                 @base</span><br><span class="line">    Dep-Install mpfr-3.1.1-4.el7.x86_64                   @base</span><br><span class="line">Scriptlet output:</span><br><span class="line">   1 warning: /etc/nsswitch.conf created as /etc/nsswitch.conf.rpmnew</span><br><span class="line">history info</span><br><span class="line">[root@localhost ~]#yum history undo 8</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Undoing transaction 8, from Thu Aug  8 23:54:00 2019</span><br><span class="line">    Dep-Install cpp-4.8.5-36.el7_6.2.x86_64               @updates</span><br><span class="line">    Install     gcc-4.8.5-36.el7_6.2.x86_64               @updates</span><br><span class="line">    Updated     glibc-2.17-105.el7.x86_64                 @anaconda</span><br><span class="line">    Update            2.17-260.el7_6.6.x86_64             @updates</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">  Verifying  : glibc-devel-2.17-260.el7_6.6.x86_64                                                                                                       2/7 </span><br><span class="line">  Verifying  : kernel-headers-3.10.0-957.27.2.el7.x86_64                                                                                                 3/7 </span><br><span class="line">  Verifying  : cpp-4.8.5-36.el7_6.2.x86_64                                                                                                               4/7 </span><br><span class="line">  Verifying  : gcc-4.8.5-36.el7_6.2.x86_64                                                                                                               5/7 </span><br><span class="line">  Verifying  : glibc-headers-2.17-260.el7_6.6.x86_64                                                                                                     6/7 </span><br><span class="line">  Verifying  : libmpc-1.0.1-3.el7.x86_64                                                                                                                 7/7 </span><br><span class="line"></span><br><span class="line">Removed:</span><br><span class="line">  cpp.x86_64 0:4.8.5-36.el7_6.2                gcc.x86_64 0:4.8.5-36.el7_6.2  glibc-devel.x86_64 0:2.17-260.el7_6.6  glibc-headers.x86_64 0:2.17-260.el7_6.6 </span><br><span class="line">  kernel-headers.x86_64 0:3.10.0-957.27.2.el7  libmpc.x86_64 0:1.0.1-3.el7    mpfr.x86_64 0:3.1.1-4.el7             </span><br><span class="line"></span><br><span class="line">Complete!</span><br></pre></td></tr></table></figure>
<p><strong><em>在对yum命令有了一定的了解以后，下面通过挂载光盘，或者基于光盘和http服务搭建yum仓库：</em></strong></p>
<blockquote>
<p>首先是用光盘作为yum源：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">（1）挂载光盘到一个指定目录：</span><br><span class="line">    mount /dev/cdrom /mnt</span><br><span class="line">（2）创建配置文件(若有其他yum源先移动到其他目录)：</span><br><span class="line">    cd /etc/yum.repos.d</span><br><span class="line">    vim base.repo</span><br><span class="line">▽</span><br><span class="line">   [centos7]</span><br><span class="line">   name=ISO</span><br><span class="line">   baseurl=file:///mnt/</span><br><span class="line">   gpgcheck=0</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>基于http服务搭建yum服务器（适用于不能访问互联网的企业）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">（1）先通过本地yum源（如上所述：）yum install -y httpd</span><br><span class="line">（2）cd /var/www/html/</span><br><span class="line">（3）mkdir centos&#123;6,7&#125;</span><br><span class="line">（4）mount /dev/cdrom /var/www/html/centos7</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>将已有的rpm包制作成yum仓库：</p>
</blockquote>
<pre><code>createrepo [options] &lt;directory&gt;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）mkdir /tmp/rpm</span><br><span class="line">（2）mv rpm文件 /tmp/rpm</span><br><span class="line">（3）createrepo /tmp/rpm/</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-关于shell脚本通过相对路径调用其它脚本失败的问题解决" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/08/04/关于shell脚本通过相对路径调用其它脚本失败的问题解决/" class="article-date">
  	<time datetime="2019-08-04T05:30:14.000Z" itemprop="datePublished">2019-08-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/04/关于shell脚本通过相对路径调用其它脚本失败的问题解决/">
        关于shell脚本通过相对路径调用其它脚本失败的问题解决
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="解决shell脚本中通过相对路径包含（调用）其它子脚本，找不到文件的问题"><a href="#解决shell脚本中通过相对路径包含（调用）其它子脚本，找不到文件的问题" class="headerlink" title="解决shell脚本中通过相对路径包含（调用）其它子脚本，找不到文件的问题"></a>解决shell脚本中通过相对路径包含（调用）其它子脚本，找不到文件的问题</h1><blockquote>
<p>先附上我个人的测试脚本：<br>（1）：在/data/script/目录下创建installmenu.sh主脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">cat &lt;&lt; ENF</span><br><span class="line">1:install Apache</span><br><span class="line">2:install Nginx</span><br><span class="line">3:install Mysql</span><br><span class="line">4:install Tomcat</span><br><span class="line">5:exit</span><br><span class="line">ENF</span><br><span class="line">read -p &quot;Please input you want install app:&quot; app</span><br><span class="line">case $app in</span><br><span class="line">1)</span><br><span class="line">    . ./app/apache.sh</span><br><span class="line">    ;;</span><br><span class="line">2)</span><br><span class="line">    . ./app/nginx.sh</span><br><span class="line">    ;;</span><br><span class="line">3)</span><br><span class="line">    . ./app/mysql.sh</span><br><span class="line">    ;;</span><br><span class="line">4)</span><br><span class="line">    . ./app/tomcat.sh</span><br><span class="line">    ;;</span><br><span class="line">5)</span><br><span class="line">    exit</span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    echo &quot;Please input 1-5!!!&quot;</span><br><span class="line">    exit</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>再在/data/script/app/目录下创建4个子脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">echo &quot;Nginx installing ...&quot;</span><br><span class="line">sleep 3</span><br><span class="line">echo &quot;Nginx install finished!!!&quot; </span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line">echo &quot;Apache installing ...&quot;</span><br><span class="line">sleep 3</span><br><span class="line">echo &quot;Apache install finished!!!&quot; </span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line">echo &quot;Tomcat installing ...&quot;</span><br><span class="line">sleep 3</span><br><span class="line">echo &quot;Tomcat install finished!!!&quot; </span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line">echo &quot;Mysql installing ...&quot;</span><br><span class="line">sleep 3</span><br><span class="line">echo &quot;Mysql install finished!!!&quot;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><strong><em>以上是通过相对路径的方法包含子脚本的。</em></strong></p>
<blockquote>
<p>会出现如下问题：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost script]#bash installmenu.sh </span><br><span class="line">1:install Apache</span><br><span class="line">2:install Nginx</span><br><span class="line">3:install Mysql</span><br><span class="line">4:install Tomcat</span><br><span class="line">5:exit</span><br><span class="line">Please input you want install app:1</span><br><span class="line">Apache installing ...</span><br><span class="line">Apache install finished!!!</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>在installmenu.sh所在目录执行不会出现任何问题。但是如果在其它位置执行该主脚本会出现如下问题：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#bash /data/script/installmenu.sh </span><br><span class="line">1:install Apache</span><br><span class="line">2:install Nginx</span><br><span class="line">3:install Mysql</span><br><span class="line">4:install Tomcat</span><br><span class="line">5:exit</span><br><span class="line">Please input you want install app:1</span><br><span class="line">/data/script/installmenu.sh: line 25: ./app/apache.sh: No such file or directory</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><strong><em>如上所示，报错：No such file or directory。若要深究其原因的话就是主脚本（installmenu.sh）在哪里执行，子脚本中的相对路径就是相对于哪里。本例中话就是在“/root”路径下找“app/apache.sh”文件。因为“/root”下没有该文件夹，故而报错。</em></strong></p>
<blockquote>
<p>以上问题有两种常用的解决方法（还有其他方法）这里仅给出两种常用且容易理解的：</p>
</blockquote>
<p>（1）将子脚本中的相对路径改为绝对路径。这种方法比较简单，是处理这类问题的常用方法。但是缺陷在于如若将脚本更改了环境（换到另一台文件结构不同与当前环境），就需要更改文件中的绝对路径了。此方法过于无脑此处的详细过程略过。</p>
<p>（2）这种方法的大体思路如下：</p>
<p>既然脚本中使用的文件或目录期望基于脚本的所在目录，那么可以在脚本中先进入到这个脚本所在的目录里，后续要使用目录和文件时，都基于此目录，用相对路径描述。</p>
<p>$0 代标脚本自己的文件名，”dirname $0”代表脚本所在的路径。<br>测试脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">echo &quot;&apos;\$0-----------&gt;&apos; $0&quot;</span><br><span class="line">echo &quot;&apos;dirname \$0---&gt;&apos; `dirname $0`&quot;</span><br><span class="line">path1=`dirname \$0`</span><br><span class="line">path2=`cd $path1;pwd`</span><br><span class="line">echo &quot;`basename $0`的位置是：$path2&quot;</span><br></pre></td></tr></table></figure></p>
<p>在家目录测试如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]#chmod +x /data/script/test1.sh</span><br><span class="line">[root@localhost ~]#test1.sh   # 我将/data/script/加入到了$PATH环境变量中。             </span><br><span class="line">&apos;$0-----------&gt;&apos; /data/script/test1.sh</span><br><span class="line">&apos;dirname $0---&gt;&apos; /data/script</span><br><span class="line">test1.sh的位置是：/data/script</span><br></pre></td></tr></table></figure></p>
<p>在/etc目录下测试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost etc]#bash ../data/script/test1.sh </span><br><span class="line">&apos;$0-----------&gt;&apos; ../data/script/test1.sh</span><br><span class="line">&apos;dirname $0---&gt;&apos; ../data/script</span><br><span class="line">test1.sh的位置是：/data/script</span><br></pre></td></tr></table></figure></p>
<p>在/data目录下测试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost date]#bash script/test1.sh </span><br><span class="line">&apos;$0-----------&gt;&apos; script/test1.sh</span><br><span class="line">&apos;dirname $0---&gt;&apos; script</span><br><span class="line">test1.sh的位置是：/data/script</span><br></pre></td></tr></table></figure></p>
<p><strong><em>综上所述：无论在何处执行脚本都能通过变量path2进入到脚本自身所在的位置。</em></strong></p>
<blockquote>
<p>代码实现如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">cat &lt;&lt; ENF</span><br><span class="line">1:install Apache</span><br><span class="line">2:install Nginx</span><br><span class="line">3:install Mysql</span><br><span class="line">4:install Tomcat</span><br><span class="line">5:exit</span><br><span class="line">ENF</span><br><span class="line">path1=`dirname $0` # -------&gt;找到脚本相对于当前位置的路径</span><br><span class="line">path2=`cd $path1;pwd` # --------&gt;取出脚本的绝对路径</span><br><span class="line">cd $path2 # --------&gt;进入脚本所在的目录</span><br><span class="line">read -p &quot;Please input you want install app:&quot; app</span><br><span class="line">case $app in</span><br><span class="line">1)</span><br><span class="line">    . ./app/apache.sh</span><br><span class="line">    ;;</span><br><span class="line">2)</span><br><span class="line">    . ./app/nginx.sh</span><br><span class="line">    ;;</span><br><span class="line">3)</span><br><span class="line">    . ./app/mysql.sh</span><br><span class="line">    ;;</span><br><span class="line">4)</span><br><span class="line">    . ./app/tomcat.sh</span><br><span class="line">    ;;</span><br><span class="line">5)</span><br><span class="line">    exit</span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    echo &quot;Please input 1-5!!!&quot;</span><br><span class="line">    exit</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br><span class="line">``` </span><br><span class="line">&gt;测试结果：</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>[root@localhost ~]#installmenu.sh<br>1:install Apache<br>2:install Nginx<br>3:install Mysql<br>4:install Tomcat<br>5:exit<br>Please input you want install app:1<br>Apache installing …<br>Apache install finished!!!<br>[root@localhost ~]#cd /etc<br>[root@localhost etc]#installmenu.sh<br>1:install Apache<br>2:install Nginx<br>3:install Mysql<br>4:install Tomcat<br>5:exit<br>Please input you want install app:3<br>mysql installing …<br>mysql install finished!!!<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;在另一台文件结果完全不同的机器上测试(centos6)：</span><br></pre></td></tr></table></figure></p>
<p>[root@localhost test]# ls<br>app<br>[root@localhost test]# ls<br>app  installmenu.sh<br>[root@localhost test]# cd<br>[root@localhost ~]# sh test/installmenu.sh<br>1:install Apache<br>2:install Nginx<br>3:install Mysql<br>4:install Tomcat<br>5:exit<br>Please input you want install app:2<br>Nginx installing …<br>Nginx install finished!!!<br><code>`</code></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/shell/">shell</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-常用的文本处理工具" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/07/29/常用的文本处理工具/" class="article-date">
  	<time datetime="2019-07-29T11:21:47.000Z" itemprop="datePublished">2019-07-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/29/常用的文本处理工具/">
        常用的文本处理工具
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>tr的常用参数：</p>
</blockquote>
<pre><code>-s 删除所有重复出现字符序列，只保留第一个；即将重复出现字符串压缩为一个字符串。
-d 删除字符串1中所有输入字符。
-s 删除所有重复出现字符序列，只保留第一个；即将重复出现字符串压缩为一个字符串。
-c 用字符串1中字符集的补集替换此字符集。

例如：
    [root@localhost ~]# cat /dev/urandom | tr -dc [a-zA-Z0-9[[:punct:]]]|head -c 12
    6FS}r`M*(~P|
-dc [a-zA-Z0-9[[:punct:]]]就是删除了标点符号和数字及字母以外的所有字符。
    [root@localhost ~]# df -h 
        Filesystem      Size  Used Avail Use% Mounted on
        /dev/sda2       100G  1.1G   99G   2% /
        devtmpfs        480M     0  480M   0% /dev
        tmpfs           489M     0  489M   0% /dev/shm
        tmpfs           489M  6.6M  483M   2% /run
        tmpfs           489M     0  489M   0% /sys/fs/cgroup
        /dev/sda5        50G   33M   50G   1% /date
        /dev/sda1      1014M  124M  891M  13% /boot
        tmpfs            98M     0   98M   0% /run/user/0
    [root@localhost ~]# df -h |grep &apos;/dev/sda.&apos;|tr -s &quot; &quot; %|cut -d% -f5
        2
        1
        13
</code></pre><blockquote>
<p>cut的常用参数：</p>
</blockquote>
<pre><code>-d DELIMITER: 指明分隔符，默认tab 。
-f FILEDS:       
#: 第#个字段       
#,#[,#]：离散的多个字段，例如1,3,6       
#-#：连续的多个字段, 例如1-6                 
混合使用：1-3,7 
-c 按字符切割  --output-delimiter=STRING指定输出分隔符。

例如：
    [root@localhost ~]# cut -d: -f1,3 /etc/passwd
        root:0
        bin:1
        daemon:2
        adm:3
        lp:4
        sync:5
        shutdown:6
        halt:7
        mail:8
        operator:11
        games:12
        ftp:14
    就是以：为为分隔符，取出第1列和第3列的数据。

    root@localhost ~]# cut -d: -f1,3 --output-delimiter=+ /etc/passwd
        root+0
        bin+1
        daemon+2
        adm+3
    就是将取出的数据以+连接。
</code></pre><blockquote>
<p>wc的常用参数：</p>
</blockquote>
<pre><code>-l 只计数行数 
-w 只计数单词总数 
-c 只计数字节总数 
-m 只计数字符总数 
-L 显示文件中最长行的长度 

例如：
    [root@localhost ~]# cut -d: -f1,3 /etc/passwd | wc -l
    31
</code></pre><blockquote>
<p>sort的常用参数:</p>
</blockquote>
<pre><code>-r 执行反方向（由上至下）整理 
-R 随机排序 
-n 执行按数字大小整理 
-f 选项忽略（fold）字符串中的字符大小写 
-u 选项（独特，unique）删除输出中的重复行 
-t  c 选项使用c做为字段界定符 
-k  X 选项按照使用c字符分隔的X列来整理能够使用多次 
</code></pre><blockquote>
<p>uniq的常用参数：</p>
</blockquote>
<pre><code>-c: 显示每行重复出现的次数  
-d: 仅显示重复过的行  
-u: 仅显示不曾重复的行           
注：连续且完全相同方为重复 
常和sort 命令一起配合使用：      
sort  userlist.txt  |  uniq  -c 

例如：[root@localhost ~]# cut -d &quot; &quot; -f 1 access_log|sort |uniq -c|sort -nr|head -n 5
4870 172.20.116.228
3429 172.20.116.208
2834 172.20.0.222
2613 172.20.112.14
2267 172.20.0.227
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-Linux文件系统的特殊权限设置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/07/27/Linux文件系统的特殊权限设置/" class="article-date">
  	<time datetime="2019-07-27T09:09:47.000Z" itemprop="datePublished">2019-07-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/27/Linux文件系统的特殊权限设置/">
        Linux文件系统的特殊权限设置
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="关于SUID，SGID，Sticky的介绍："><a href="#关于SUID，SGID，Sticky的介绍：" class="headerlink" title="关于SUID，SGID，Sticky的介绍："></a>关于SUID，SGID，Sticky的介绍：</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SUID只对二进制可执行程序有效</span><br><span class="line">SUID设置在目录上无意义</span><br><span class="line">权限设定：</span><br><span class="line">chmod u+s FILE</span><br><span class="line">chmod u-s FILE</span><br></pre></td></tr></table></figure>
<pre><code>[root@localhost ~]# ll /etc/shadow
----------. 1 root root 1305 Jul 27 10:40 /etc/shadow
[root@localhost ~]# su - tom
Last login: Sat Jul 27 16:27:48 CST 2019 on pts/0
[tom@localhost ~]$ cat /etc/shadow
cat: /etc/shadow: Permission denied
</code></pre><blockquote>
<p>在设置了SUID以后：</p>
</blockquote>
<pre><code>[root@localhost ~]# ll /usr/bin/cat
-rwxr-xr-x. 1 root root 54048 Nov 20  2015 /usr/bin/cat
[root@localhost ~]# chmod 4755 /usr/bin/cat
[root@localhost ~]# ll /usr/bin/cat
-rwsr-xr-x. 1 root root 54048 Nov 20  2015 /usr/bin/cat
[root@localhost ~]# su - tom
Last login: Sat Jul 27 17:15:46 CST 2019 on pts/1
[tom@localhost ~]$ cat /etc/shadow
root:$6$jKdGQ3pHIKpx.rHy$Z8Vvbme3U29FF36Gi6d6w2U9g1O7V8x3RMzBUv9A.sgL9QzKVfpGVPePMsA8GO7Jk61mfu6MGlO9mEb2njMdQ/::0:99999:7:::
bin:*:16659:0:99999:7:::
daemon:*:16659:0:99999:7:::
adm:*:16659:0:99999:7:::
</code></pre><p><strong><em>SUID可以让一个程序的发起者临时借用该程序属主的权限。</em></strong></p>
<blockquote>
<p>在设置了SGID以后：</p>
</blockquote>
<p><strong><em>(1)作用于二进制可执行程序，当用户执行此程序时，将会临时继承此程序所属组的权限</em></strong></p>
<p><strong><em>(2)作用于目录，当用户在此目录下创建新文件时，文件的所属组会自动继承此目录的所属组</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 2 root  root    45 Jul 27 15:07 dir1</span><br><span class="line">drwxr-xr-x. 2 root  root     6 Jul 27 17:29 dir2</span><br><span class="line">-rwxrw-r--. 1 user1 user1 1162 Jul 26 20:46 f1.txt</span><br><span class="line">[root@localhost date]# chown :test dir2</span><br><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 2 root  root    45 Jul 27 15:07 dir1</span><br><span class="line">drwxr-xr-x. 2 root  test     6 Jul 27 17:29 dir2</span><br><span class="line">-rwxrw-r--. 1 user1 user1 1162 Jul 26 20:46 f1.txt</span><br></pre></td></tr></table></figure>
<p>正常情况下在dir2目录下建文件，所建文件的属组是创建文件者的主组。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost dir2]# touch f1</span><br><span class="line">[root@localhost dir2]# ll</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r--. 1 root root 0 Jul 27 17:33 f1</span><br></pre></td></tr></table></figure>
<p>在针对dir2目录设置SGID以后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost date]# chmod 2755 dir2</span><br><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 2 root  root    45 Jul 27 15:07 dir1</span><br><span class="line">drwxr-sr-x. 2 root  test    15 Jul 27 17:33 dir2</span><br><span class="line">-rwxrw-r--. 1 user1 user1 1162 Jul 26 20:46 f1.txt</span><br><span class="line">[root@localhost dir2]# touch f2</span><br><span class="line">[root@localhost dir2]# ll</span><br><span class="line">total 0</span><br><span class="line">-rw-r--r--. 1 root root 0 Jul 27 17:33 f1</span><br><span class="line">-rw-r--r--. 1 root test 0 Jul 27 17:36 f2</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>在设置stikcy以后：</p>
</blockquote>
<p><strong><em>stikcy:作用于目录，用户只能删除自已的文件,在目录设置Sticky 位，只有文件的所有者或root可以删除该文件</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[jim@localhost dir3]$ ll</span><br><span class="line">total 0</span><br><span class="line">-rw-rw-r--. 1 jim jim 0 Jul 27 18:18 jim1</span><br><span class="line">-rw-rw-r--. 1 jim jim 0 Jul 27 18:18 jim2</span><br><span class="line">-rw-rw-r--. 1 tom tom 0 Jul 27 18:17 tom1</span><br><span class="line">-rw-rw-r--. 1 tom tom 0 Jul 27 18:17 tom2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在正常情况下jim可以删除tom的文件，tom也可以删除jim的文件：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[jim@localhost dir3]$ rm tom1</span><br><span class="line">rm: remove write-protected regular empty file ‘tom1’? y</span><br><span class="line">[jim@localhost dir3]$ ll</span><br><span class="line">total 0</span><br><span class="line">-rw-rw-r--. 1 jim jim 0 Jul 27 18:18 jim1</span><br><span class="line">-rw-rw-r--. 1 jim jim 0 Jul 27 18:18 jim2</span><br><span class="line">-rw-rw-r--. 1 tom tom 0 Jul 27 18:17 tom2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在dir3目录设置stikcy后：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost date]# chmod 1777 dir3</span><br><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 2 root  root    45 Jul 27 15:07 dir1</span><br><span class="line">drwxr-sr-x. 2 root  test    24 Jul 27 17:36 dir2</span><br><span class="line">drwxrwxrwt. 2 root  root    39 Jul 27 18:20 dir3</span><br><span class="line">-rwxrw-r--. 1 user1 user1 1162 Jul 26 20:46 f1.txt</span><br><span class="line">[root@localhost date]# cd dir3/</span><br><span class="line">[root@localhost dir3]# ll</span><br><span class="line">total 0</span><br><span class="line">-rw-rw-r--. 1 jim jim 0 Jul 27 18:18 jim1</span><br><span class="line">-rw-rw-r--. 1 jim jim 0 Jul 27 18:18 jim2</span><br><span class="line">-rw-rw-r--. 1 tom tom 0 Jul 27 18:17 tom2</span><br><span class="line">[root@localhost dir3]# su tom</span><br><span class="line">[tom@localhost dir3]$ rm jim1</span><br><span class="line">rm: cannot remove ‘jim1’: Operation not permitted</span><br></pre></td></tr></table></figure>
<h2 id="设置文件或目录不能被修改："><a href="#设置文件或目录不能被修改：" class="headerlink" title="设置文件或目录不能被修改："></a>设置文件或目录不能被修改：</h2><pre><code>chattr +i 不能删除，改名，更改
chattr +a 只能追加内容
lsattr 显示特定属性
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 2 root  root    45 Jul 27 15:07 dir1</span><br><span class="line">drwxr-sr-x. 2 root  test    24 Jul 27 17:36 dir2</span><br><span class="line">drwxrwxrwt. 2 root  root    39 Jul 27 18:20 dir3</span><br><span class="line">-rwxrw-r--. 1 user1 user1 1162 Jul 26 20:46 f1.txt</span><br><span class="line">[root@localhost date]# rm -rf dir1</span><br><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">drwxr-sr-x. 2 root  test    24 Jul 27 17:36 dir2</span><br><span class="line">drwxrwxrwt. 2 root  root    39 Jul 27 18:20 dir3</span><br><span class="line">-rwxrw-r--. 1 user1 user1 1162 Jul 26 20:46 f1.txt</span><br><span class="line">[root@localhost date]# chattr +i dir2</span><br><span class="line">[root@localhost date]# rm -rf dir2</span><br><span class="line">rm: cannot remove ‘dir2/f1’: Permission denied</span><br><span class="line">rm: cannot remove ‘dir2/f2’: Permission denied</span><br><span class="line">[root@localhost date]# cd dir2</span><br><span class="line">[root@localhost dir2]# ls</span><br><span class="line">f1  f2</span><br><span class="line">[root@localhost dir2]# touch f3</span><br><span class="line">touch: cannot touch ‘f3’: Permission denied</span><br><span class="line">[root@localhost date]# lsattr </span><br><span class="line">---------------- ./f1.txt</span><br><span class="line">----i----------- ./dir2</span><br><span class="line">---------------- ./dir3</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-Linux用户组的添加及属性的更改" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/07/27/Linux用户组的添加及属性的更改/" class="article-date">
  	<time datetime="2019-07-27T02:45:58.000Z" itemprop="datePublished">2019-07-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/27/Linux用户组的添加及属性的更改/">
        Linux用户组的添加及属性的更改
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>用户组的创建：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">groupadd [OPTION]  组名</span><br><span class="line">    -g GID 指明GID号；[GID_MIN, GID_MAX]</span><br><span class="line">    -r 创建系统组</span><br><span class="line">        CentOS 6: ID&lt;500</span><br><span class="line">        CentOS 7: ID&lt;1000</span><br></pre></td></tr></table></figure>
<blockquote>
<p>用户组的修改</p>
</blockquote>
<pre><code>groupmod [OPTION]  组名
    -n group_name: 新名字
    -g GID: 新的GID
</code></pre><blockquote>
<p>用户组的删除</p>
</blockquote>
<pre><code>groupdel 组名
</code></pre><blockquote>
<p>更改和查看组成员：</p>
</blockquote>
<pre><code>groupmems [options] [action]
    options：
        -g, --group groupname 更改为指定组 (只有root)
    actions:
        -a, --add username 指定用户加入组
        -d, --delete username 从组中删除用户
        -p, --purge 从组中清除所有成员
        -l, --list 显示组成员列表
</code></pre><blockquote>
<p>首先通过groupadd 组名创建一个新组。并通过groupmems -a 用户名 -g 组名添加一个用户到某个组中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# groupadd test</span><br><span class="line">[root@localhost ~]# getent group test</span><br><span class="line">test:x:1008:</span><br><span class="line">[root@localhost ~]# groupmems -a tom -g test</span><br><span class="line">[root@localhost ~]# groupmems -a jim -g test</span><br><span class="line">[root@localhost ~]# groupmems -a user1 -g test</span><br><span class="line">[root@localhost ~]# groupmems -a user2 -g test</span><br><span class="line">[root@localhost ~]# getent group test</span><br><span class="line">test:x:1008:tom,jack,jim,user1,user2</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>添加删除用户到组中的另一种方法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# gpasswd -a tom jim</span><br><span class="line">Adding user tom to group jim</span><br><span class="line">[root@localhost ~]# gpasswd -d tom test</span><br><span class="line">Removing user tom from group test</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>通过groupmems -l -g 组名，列出该组的成员。</p>
</blockquote>
<pre><code>[root@localhost ~]# groupmems -l -g test
    tom  jack  jim  user1  user2 
</code></pre><blockquote>
<p>groups [OPTION].[USERNAME]  查看用户所属组列表</p>
</blockquote>
<pre><code>[root@localhost ~]# groups tom
tom : tom jim
[root@localhost ~]# id tom
uid=1000(tom) gid=1000(tom) groups=1000(tom),1001(jim)
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-ACL权限控制总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/07/26/ACL权限控制总结/" class="article-date">
  	<time datetime="2019-07-26T11:52:33.000Z" itemprop="datePublished">2019-07-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/26/ACL权限控制总结/">
        ACL权限控制总结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在centos7中默认创建的文件系统具有ACL功能。而在此之前的版本默认手工创建的文件系统并无ACL功能需要手动添加。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">getfacl file |directory</span><br><span class="line">setfacl -m u:wang:rwx file|directory</span><br><span class="line">setfacl -m g:admins:rw file| directory</span><br><span class="line">setfacl -x u:wang file |directory</span><br><span class="line">setfacl -b file1 清除所有ACL权限</span><br><span class="line">getfacl file1 | setfacl --set-file=- file2 复制file1的acl权限给file2</span><br></pre></td></tr></table></figure></p>
<p>mask只影响除所有者和other的之外的人和组的最大权限。</p>
<p>mask需要与用户的权限进行逻辑与运算后，才能变成有限的权限。</p>
<p>用户或组的设置必须存在于mask权限设定范围内才会生效。</p>
<pre><code>--set选项会把原有的ACL项都删除，用新的替代，需要注意的是一定要包含
UGO的设置，不能象-m一样只是添加ACL就可以
    setfacl --set u::rw,u:wang:rw,g::r,o::- file1
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">主要的文件操作命令cp和mv都支持ACL，只是cp命令需要加上-p 参数。但是</span><br><span class="line">tar等常见的备份工具是不会保留目录和文件的ACL信息</span><br><span class="line">getfacl -R /tmp/dir1 &gt; acl.txt</span><br><span class="line">setfacl -R -b /tmp/dir1</span><br><span class="line">setfacl -R --set-file=acl.txt /tmp/dir1</span><br><span class="line">setfacl --restore acl.txt</span><br><span class="line">getfacl -R /tmp/dir1</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-Linux文件权限总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/07/26/Linux文件权限总结/" class="article-date">
  	<time datetime="2019-07-26T11:19:22.000Z" itemprop="datePublished">2019-07-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/26/Linux文件权限总结/">
        Linux文件权限总结
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>chown可以用来修改文件的属主和属组：</p>
</blockquote>
<pre><code>chown [OPTION]  [OWNER][:[GROUP]] 修改文件的所属主和属组。
    -R: 递归
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r--. 1 root root 1162 Jul 26 20:46 f1.txt</span><br><span class="line">[root@localhost date]# chown user1:user1 f1.txt </span><br><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r--. 1 user1 user1 1162 Jul 26 20:46 f1.txt</span><br></pre></td></tr></table></figure>
<pre><code>[root@localhost dir1]# ll
total 4
-rw-r--r--. 1 root root 5 Jul 27 15:08 f1.txt
-rw-r--r--. 1 root root 0 Jul 27 15:07 f2.txt
-rw-r--r--. 1 root root 0 Jul 27 15:07 f3.txt
[root@localhost dir1]# chown jim f1.txt 
[root@localhost dir1]# ll
total 4
-rw-r--r--. 1 jim  root 5 Jul 27 15:08 f1.txt
-rw-r--r--. 1 root root 0 Jul 27 15:07 f2.txt
-rw-r--r--. 1 root root 0 Jul 27 15:07 f3.txt
[root@localhost dir1]# chown :test f1.txt      #冒号后跟组名更改属组
[root@localhost dir1]# ll
total 4
-rw-r--r--. 1 jim  test 5 Jul 27 15:08 f1.txt
-rw-r--r--. 1 root root 0 Jul 27 15:07 f2.txt
-rw-r--r--. 1 root root 0 Jul 27 15:07 f3.txt
</code></pre><blockquote>
<p>修改文件的属组：chgrp<br>    chgrp [OPTION]  GROUP FILE…<br>    chgrp [OPTION]  –reference=RFILE FILE<br>        -R 递归</p>
</blockquote>
<pre><code>[root@localhost dir1]# chgrp jack f3.txt 
[root@localhost dir1]# ll
total 4
-rw-r--r--. 1 jim  test 5 Jul 27 15:08 f1.txt
-rw-r--r--. 1 root root 0 Jul 27 15:07 f2.txt
-rw-r--r--. 1 root jack 0 Jul 27 15:07 f3.txt
</code></pre><p><strong><em>目录权限中，x执行权限是基本权限，若没有执行权限就无法进入该目录。目录下的文件的创建与删除取决于该目录的w写权限。</em></strong></p>
<p><strong><em>X（大写） 只给目录x权限，不给文件x权限</em></strong></p>
<blockquote>
<p>修改文件权限：chmod [OPTION]  MODE[,MODE]  FILE</p>
</blockquote>
<p>-R 递归修改权限</p>
<pre><code>MODE：
修改一类用户的所有权限
    u= g= o= ug= a= u=,g=
修改一类用户某位或某些位权限
    u+ u- g+ g- o+ o- a+ a- + -
chmod [OPTION] --reference=RFILE FILE
    参考RFILE文件的权限，将FILE的修改为同RFILE
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 2 root  root    45 Jul 27 15:07 dir1</span><br><span class="line">-rw-r--r--. 1 user1 user1 1162 Jul 26 20:46 f1.txt</span><br><span class="line">[root@localhost date]# chmod u=rwx,g=rw,o=r f1.txt </span><br><span class="line">[root@localhost date]# ll</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 2 root  root    45 Jul 27 15:07 dir1</span><br><span class="line">-rwxrw-r--. 1 user1 user1 1162 Jul 26 20:46 f1.txt</span><br></pre></td></tr></table></figure>
<pre><code>[root@localhost dir1]# ll
total 4
-rw-r--r--. 1 jim  test 5 Jul 27 15:08 f1.txt
-rw-r--r--. 1 root root 0 Jul 27 15:07 f2.txt
-rw-r--r--. 1 root jack 0 Jul 27 15:07 f3.txt
[root@localhost dir1]# chmod u+x f3.txt 
[root@localhost dir1]# ll
total 4
-rw-r--r--. 1 jim  test 5 Jul 27 15:08 f1.txt
-rw-r--r--. 1 root root 0 Jul 27 15:07 f2.txt
-rwxr--r--. 1 root jack 0 Jul 27 15:07 f3.txt
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-Linux用户添加及属性修改" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/07/26/Linux用户添加及属性修改/" class="article-date">
  	<time datetime="2019-07-26T11:18:25.000Z" itemprop="datePublished">2019-07-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/26/Linux用户添加及属性修改/">
        Linux用户添加及属性修改
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>用户创建（创建用户时，会从默认的/etc/skel/目录下复制目录结构到所创建用户的家目录下。默认的用户创建配置文件在/etc/default/useradd）</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# cat /etc/default/useradd </span><br><span class="line"># useradd defaults file</span><br><span class="line">GROUP=100</span><br><span class="line">HOME=/home</span><br><span class="line">INACTIVE=-1</span><br><span class="line">EXPIRE=</span><br><span class="line">SHELL=/bin/bash</span><br><span class="line">SKEL=/etc/skel</span><br><span class="line">CREATE_MAIL_SPOOL=yes</span><br></pre></td></tr></table></figure>
<pre><code>useradd [options] 用户名
    -u 指定UID。
    -o 配合-u 选项，不检查UID的唯一性，若想要两个用户UID相同可以强制指定UID。
    -g GID 指明用户所属基本组（主组），可为组名，也可以GID。
    -c &quot;COMMENT“ 用户的注释信息。
    -d HOME_DIR 以指定的路径(不存在)为家目录。
    -s SHELL 指明用户的默认shell程序，可用列表在/etc/shells文件中。
    -G GROUP1[,GROUP2,...] 为用户指明附加组，组须事先存在可以是组名亦可是UID。
    -N 不创建私用组做主组，使用users组（gid=100）做主组。
    -r 创建系统用户 CentOS 6: ID&lt;500，CentOS 7: ID&lt;1000（默认不创建家目录，可以使用-m创建）。
    -m 创建家目录，用于系统用户。
    -M 不创建家目录，用于非系统用户。
</code></pre><blockquote>
<p>创建一个登陆后就要求更改密码的用户：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# useradd jack;echo testroot | passwd --stdin jack;passwd -e jack</span><br><span class="line">Changing password for user jack.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line">Expiring password for user jack.</span><br><span class="line">passwd: Success</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>创建系统用户（Apache,MySQL，Nginx等）</p>
</blockquote>
<pre><code>useradd -r 用户名 -s /sbin/nologin
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# useradd -r nginx -s /sbin/nologin</span><br><span class="line">[root@localhost home]# ls</span><br><span class="line">jack  jim  tom</span><br><span class="line">[root@localhost home]# getent passwd nginx</span><br><span class="line">nginx:x:995:993::/home/nginx:/sbin/nologin</span><br></pre></td></tr></table></figure>
<blockquote>
<p>根据文件批量创建用户，并根据文件批量为用户添加密码：</p>
</blockquote>
<pre><code>newusers passwd格式文件            批量创建用户
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cat passwd.txt </span><br><span class="line">user1:x:1005:1005:This is test!:/home/user1:/sbin/bash</span><br><span class="line">user2:x:1006:1007:This is test!:/home/user2:/sbin/bash</span><br><span class="line">[root@localhost ~]# newusers passwd.txt </span><br><span class="line">[root@localhost ~]# cat /etc/passwd</span><br><span class="line">postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br><span class="line">sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">chrony:x:996:994::/var/lib/chrony:/sbin/nologin</span><br><span class="line">tom:x:1000:1000::/home/tom:/bin/bash</span><br><span class="line">jim:x:1001:1001::/home/jim:/bin/bash</span><br><span class="line">jack:x:1002:1002::/home/jack:/bin/bash</span><br><span class="line">nginx:x:995:993::/home/nginx:/sbin/nologin</span><br><span class="line">user1:x:1005:1005:This is test!:/home/user1:/sbin/bash</span><br><span class="line">user2:x:1006:1007:This is test!:/home/user2:/sbin/bash</span><br></pre></td></tr></table></figure>
<blockquote>
<p>根据文件批量修改用户名密码：</p>
</blockquote>
<pre><code>cat shadow格式文件 | chpasswd      批量更改用户密码
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cat pass.txt </span><br><span class="line">user1:testroot</span><br><span class="line">user2:testroot</span><br><span class="line">[root@localhost ~]# cat pass.txt | chpasswd </span><br><span class="line">[root@localhost ~]# cat /etc/shadow</span><br><span class="line">user1:$6$XrEnzKv1yN/5$/p9/R/.4MzvzMbjsIPK1NM39mLW6hK4klP6IluSU7NJfSL2Dci4uxVoHkUfYRPqTx79o4Nqtb1NoF5w1N1lfP0:18104:0:99999:7:::</span><br><span class="line">user2:$6$Npauj/s4aeC/pGK$nLpC6QWIsXXjtDeIf5u0hbbNaesU/yTyObXoJtIluD.OFZf0MLVwmzsdfeI/hbQpyG7zufy.fbPWN2BQ3meDH1:18104:0:99999:7:::</span><br></pre></td></tr></table></figure>
<blockquote>
<p>更改用户属性</p>
</blockquote>
<pre><code>usermod [OPTION] 用户名  
-u UID: 新UID
-g GID: 新主组  
-G GROUP1[,GROUP2,...[,GROUPN]]]：新附加组，原来的附加组将会被 覆盖；若保留原有，则要同时使用-a选项  
-s SHELL：新的默认SHELL  
-c &apos;COMMENT&apos;：新的注释信息  
-d HOME: 新家目录不会自动创建；若要创建新家目录并移动原家数据， 同时使用-m选项  
-l login_name: 新的名字  
-L: lock指定用户,在/etc/shadow 密码栏的增加 !   
-U: unlock指定用户,将 /etc/shadow 密码栏的 ! 拿掉  
-e YYYY-MM-DD: 指明用户账号过期日期  
-f INACTIVE: 设定非活动期限
</code></pre><blockquote>
<p>为用户追加新的附加组：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# id user1</span><br><span class="line">uid=1005(user1) gid=1005(user1) groups=1005(user1)</span><br><span class="line">[root@localhost ~]# usermod -aG user2,tom,jack user1</span><br><span class="line">[root@localhost ~]# id user1</span><br><span class="line">uid=1005(user1) gid=1005(user1) groups=1005(user1),1000(tom),1002(jack),1007(user2)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>锁定指定用户：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cat /etc/shadow</span><br><span class="line">user1:$6$XrEnzKv1yN/5$/p9/R/.4MzvzMbjsIPK1NM39mLW6hK4klP6IluSU7NJfSL2Dci4uxVoHkUfYRPqTx79o4Nqtb1NoF5w1N1lfP0:18104:0:99999:7:::</span><br><span class="line">user2:$6$Npauj/s4aeC/pGK$nLpC6QWIsXXjtDeIf5u0hbbNaesU/yTyObXoJtIluD.OFZf0MLVwmzsdfeI/hbQpyG7zufy.fbPWN2BQ3meDH1:18104:0:99999:7:::</span><br><span class="line">[root@localhost ~]# usermod -L user1</span><br><span class="line">[root@localhost ~]# cat /etc/shadow</span><br><span class="line">user1:!$6$XrEnzKv1yN/5$/p9/R/.4MzvzMbjsIPK1NM39mLW6hK4klP6IluSU7NJfSL2Dci4uxVoHkUfYRPqTx79o4Nqtb1NoF5w1N1lfP0:18104:0:99999:7:::</span><br><span class="line">user2:$6$Npauj/s4aeC/pGK$nLpC6QWIsXXjtDeIf5u0hbbNaesU/yTyObXoJtIluD.OFZf0MLVwmzsdfeI/hbQpyG7zufy.fbPWN2BQ3meDH1:18104:0:99999:7:::</span><br></pre></td></tr></table></figure>
<blockquote>
<p>更改用户的shell:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cat /etc/passwd</span><br><span class="line">user1:x:1005:1005:This is test!:/home/user1:/sbin/bash</span><br><span class="line">user2:x:1006:1007:This is test!:/home/user2:/sbin/bash</span><br><span class="line">[root@localhost ~]# usermod -s /sbin/csh user1</span><br><span class="line">[root@localhost ~]# cat /etc/passwd</span><br><span class="line">user1:x:1005:1005:This is test!:/home/user1:/sbin/csh</span><br><span class="line">user2:x:1006:1007:This is test!:/home/user2:/sbin/bash</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>删除用户</p>
</blockquote>
<pre><code>userdel [OPTION] 用户名
    -r: 删除用户家目录以及邮件目录
</code></pre><blockquote>
<p>查看用户相关的id信息，可以使用 id  用户名  判断用户是否存在。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">id [OPTION]... [USER]  </span><br><span class="line">    -u: 显示UID  </span><br><span class="line">    -g: 显示GID  </span><br><span class="line">    -G: 显示用户所属的组的ID  </span><br><span class="line">    -n: 显示名称，需配合ugG使用</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# id user1</span><br><span class="line">uid=1005(user1) gid=1005(user1) groups=1005(user1),1000(tom),1002(jack),1007(user2)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>用户密码的相关修改</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">passwd [OPTIONS] UserName: 修改指定用户的密码 </span><br><span class="line">         -d：删除指定用户密码      </span><br><span class="line">         -l：锁定指定用户      </span><br><span class="line">         -u：解锁指定用户      </span><br><span class="line">         -e：强制用户下次登录修改密码    </span><br><span class="line">         -f：强制操作      </span><br><span class="line">         -n mindays：指定最短使用期限      </span><br><span class="line">         -x maxdays：最大使用期限     </span><br><span class="line">         -w warndays：提前多少天开始警告      </span><br><span class="line">         -i inactivedays：非活动期限      </span><br><span class="line">         --stdin：从标准输入接收用户密码 </span><br><span class="line">            示例：echo &quot;PASSWORD&quot; | passwd --stdin USERNAME </span><br><span class="line">[root@localhost ~]# echo 1234567 | passwd --stdin user1 &amp;&gt;/dev/null</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-Linux小技巧" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/07/26/Linux小技巧/" class="article-date">
  	<time datetime="2019-07-26T11:17:27.000Z" itemprop="datePublished">2019-07-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/26/Linux小技巧/">
        Linux小技巧
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>生成随机密码:</p>
</blockquote>
<pre><code>[root@localhost ~]# cat /dev/urandom |tr -dc &apos;a-zA-Z0-9&apos;|head -c 12
ELOTIcFBGE01
 -d --delete：删除所有属于第一字符集的字符
 -c –C --complement：取字符集的补集      #tr的选项,-dc删除第一字符集以外的所有字符
 -c 取前多少位的字符                     #head的选项
</code></pre><blockquote>
<p>用户家目录被删恢复方法：<br>    1.进入单用户模式<br>    2.复制/etc/skel/到/home/用户名  </p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/linux/">linux</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2019 ConqUeroR
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>